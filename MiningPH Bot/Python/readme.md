The atrocity of this code is really bad
